# API 测试工具说明

本项目包含三个API测试工具，用于验证后端API接口的正确性和功能：

## 1. 简单API测试工具 (simpleApiTester.js)

这是一个轻量级的测试工具，专注于测试先前问题接口（如习惯的完成/取消完成接口）以及其他关键API端点。

### 运行方式：
```bash
node test/simpleApiTester.js
```

特点：
- 彩色控制台输出，方便查看测试结果
- 专注于关键接口的测试
- 测试完成后会自动清理创建的测试数据
- 测试流程：登录 -> 创建习惯 -> 测试完成习惯 -> 测试取消完成习惯 -> 测试日历任务 -> 测试助手对话 -> 清理数据

## 2. 完整API端点验证工具 (apiEndpointVerifier.js)

这是一个全面的API测试工具，会测试apiDocs.md文档中记录的所有API端点。

### 运行方式：
```bash
node test/apiEndpointVerifier.js
```

特点：
- 全面覆盖所有API端点
- 详细的测试报告，包括通过、失败和跳过的测试数量
- 测试中会创建实际资源，并在测试后进行清理
- 测试依赖关系处理：确保先测试创建接口，然后使用创建的资源测试其他接口

## 3. 习惯API自动化测试工具 (habitApiTest.js)

这是一个针对习惯管理功能的专用测试工具，会按照特定顺序测试所有习惯相关的API端点。

### 运行方式：
```bash
node test/habitApiTest.js
```

特点：
- 彩色控制台输出，详细的响应数据显示
- 专注于习惯管理API的完整流程测试
- 自动处理依赖关系（确保先获取token，再创建习惯，然后测试其他功能）
- 测试失败会提前终止后续依赖测试，并清晰显示错误原因
- 最后会生成综合测试报告
- 测试流程：健康检查 -> 登录 -> 获取所有习惯 -> 获取习惯标签 -> 创建习惯 -> 获取特定习惯 -> 更新习惯 -> 完成习惯 -> 取消完成习惯 -> 删除习惯

## 测试准备

1. 确保后端服务器正在运行（默认端口3000）
2. 确保已安装所需的npm包：
   ```bash
   npm install axios
   ```
3. 测试工具使用以下测试用户：
   - habitApiTest.js: 
     - 邮箱：abc1567849@gmail.com
     - 密码：123456
   - 其他工具:
     - 邮箱：test@example.com
     - 密码：testpassword123
   
   请确保这些用户已在系统中创建，或者修改测试文件中的测试用户凭证。

## 故障排除

如果测试失败，可能有以下原因：

1. 后端服务器未运行或无法访问
   - 解决方案：启动后端服务器，确保它在http://localhost:3000上运行

2. 认证失败
   - 解决方案：检查测试用户凭证是否正确，确保该用户存在于系统中

3. 接口路径不匹配
   - 解决方案：检查测试文件中的API路径与后端实际路径是否一致
   - habitApiTest.js脚本中使用的是`/api/v1`作为基础路径

4. 接口参数不匹配
   - 解决方案：检查测试文件中的请求参数与后端接口要求是否一致

5. 数据库连接问题
   - 解决方案：确保数据库服务正常运行，并且后端可以正常连接

## 测试结果解读

测试工具使用了不同的颜色来标识测试结果：

- ✓ 绿色：测试通过
- ✗ 红色：测试失败
- ⚠️ 黄色：警告或跳过的测试

如果出现测试失败，工具会尽可能显示详细的错误信息，包括HTTP状态码和响应数据，以帮助诊断问题。 